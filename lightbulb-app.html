<link rel="import" href="bower_components/polymer/polymer.html"/>
<link rel="import" href="bower_components/iron-input/iron-input.html"/>

<dom-module id="lightbulb-app">
    <template>
        <style>
            .form.input {
                width: 100px;
                margin-bottom: 5px;
            }
        </style>
        <form>
            <span>Number of lights: </span>
            <div class$="form input {{inputClass}}">
                <input is="iron-input" bind-value="{{numberOfLights}}"/>
            </div>
            <br/>
            <span>Number of users: </span>
            <div class$="form input {{inputClass}}">
                <input is="iron-input" bind-value="{{numberOfUsers}}"/>
            </div>
        </form>

        <button class$={{buttonClass}} on-tap="alterLights">Calculate</button>

        <table class$="{{tableClass}}">
            <thead>
                <tr><th>Light #</th>
                <th>IsOn</th>
            </tr></thead>
            <tbody>
                <template is="dom-repeat" items="{{room.lights}}">
                    <tr>
                    <td>{{item.position}}</td>
                    <td>{{item.isOn}}</td>
                    </tr>
                </template>
            </tbody>
        </table>
    </template>
    <!--tablesort-->
    <script src="tablesort.js"></script>
    <!--my scripts-->
    <script src="room.js"></script>
    <script>
        Polymer({
            is: 'lightbulb-app',
            properties: {
                buttonClass: String,
                inputClass: String,
                numberOfLights: {
                    type: Number,
                    value: 10
                },
                numberOfUsers: {
                    type: Number,
                    value: 2
                },
                room: {
                    type: Object,
                    value: function () {
                        return new Room();
                    }
                },
                tableClass: String
            },
            ready: function() {
                $("table").tablesort();
            },
            alterLights: function() {
                var room = new Room(this.numberOfLights);

                for (var i = 1; i <= this.numberOfUsers; i++) {
                    room.changeLightStateEveryMultipleOf(i);
                }

                this.set('room.lights', room.lights);
            }
        });
    </script>
</dom-module>